# 软件功能设想与架构设计

> **创建日期**: 2025-10-08  
> **版本**: 1.0  
> **状态**: 设计阶段

---

## 📋 目录

1. [项目目标](#项目目标)
2. [核心概念](#核心概念)
3. [软件功能模块](#软件功能模块)
4. [工作流程设计](#工作流程设计)
5. [DTO架构设计](#dto架构设计)
6. [配置文件结构](#配置文件结构)
7. [开发路线图](#开发路线图)

---

## 🎯 项目目标

开发一套**基于OAK相机的自动抓取系统**，具备以下特点：

1. **模块化架构** - 各功能模块独立，易于维护和扩展
2. **灵活配置** - 设备可热插拔，参数可热更新
3. **可视化调试** - 提供GUI界面辅助调试和参数调整
4. **生产就绪** - 面向客户，可部署到生产环境

---

## 🔑 核心概念

### 1. 设备角色（Device Role）

**类比**：车的四个轮子位置（固定的功能位置）

```
设备角色 = 功能位置（固定）
├─ LEFT_CAMERA   - 左相机位置
├─ RIGHT_CAMERA  - 右相机位置
└─ CENTER_CAMERA - 中央相机位置（预留）
```

**特点**：
- ✅ 角色是固定的（左相机就是左相机位置）
- ✅ 角色用枚举表示，避免拼写错误
- ✅ 角色是配置的主键

### 2. 设备MXid（可更换）

**类比**：轮子本身（可以更换）

```
MXid = 物理设备标识（灵活）
├─ 14442C10D13D0D0000 - 设备A
├─ 14442C10D13D0D0001 - 设备B
└─ 14442C10D13D0D0002 - 设备C
```

**特点**：
- ✅ MXid唯一标识一个物理设备
- ✅ 设备可以更换（损坏、升级等）
- ✅ 一个角色可以记住多个曾经用过的MXid

### 3. 自动设备识别机制

**核心思想**：每个角色记住"曾经使用过的MXid"，启动时自动匹配

```
启动流程：
1. 系统调用 dai.DeviceBootloader.getAllAvailableDevices()
2. 获取当前连接的所有在线MXid
3. 遍历每个角色的 historical_mxids
4. 如果发现匹配，自动分配给对应角色
5. 快速启动，无需手动配置

示例：
├─ LEFT_CAMERA.historical_mxids = ["MXid_A", "MXid_D"]
├─ RIGHT_CAMERA.historical_mxids = ["MXid_B"]
├─ 在线设备: ["MXid_A", "MXid_B"]
└─ 自动匹配:
    ├─ MXid_A → LEFT_CAMERA
    └─ MXid_B → RIGHT_CAMERA
```

### 4. 配置与设备解耦

**关键设计**：坐标变换参数等配置绑定到角色，而不是MXid

```
正确设计：
├─ LEFT_CAMERA 的坐标变换参数 = [x, y, z, ...]
├─ 左相机位置的设备换了（MXid_A → MXid_D）
└─ 坐标变换参数不变，直接使用

错误设计：
├─ MXid_A 的坐标变换参数 = [x, y, z, ...]
├─ 设备换了 → 参数丢失
└─ 需要重新标定 ❌
```

---

## 📦 软件功能模块

### 阶段0：核心运行时系统（已完成/进行中）

| 模块 | 功能 | 状态 |
|-----|------|------|
| **DTO系统** | 数据传输对象，类型安全 | ✅ 基础完成 |
| **事件总线** | 模块间通信 | ✅ 完成 |
| **配置管理器** | 配置文件读写 | ✅ 完成 |
| **设备发现** | 检测OAK设备 | ⏳ 基础完成 |
| **数据采集** | 视频流和检测数据 | ⏳ 进行中 |
| **数据调度** | 数据处理流水线 | ⏳ 设计中 |
| **运动控制** | 机械臂控制 | ⏳ 规划中 |

---

### 阶段1：设备绑定工具（GUI）

**目标**：首次部署时，快速完成设备到角色的绑定

#### 功能1.1：设备发现与预览

```
界面布局：
┌────────────────────────────────────────┐
│  设备绑定工具 - 设备发现              │
├────────────────────────────────────────┤
│                                        │
│  检测到的设备列表：                    │
│  ┌──────────────────────────────────┐ │
│  │ □ 14442C10D13D0D0000 (OAK-D)     │ │
│  │ □ 14442C10D13D0D0001 (OAK-D)     │ │
│  │ □ 14442C10D13D0D0002 (OAK-D-Lite)│ │
│  └──────────────────────────────────┘ │
│                                        │
│  [刷新设备列表] [预览选中设备]         │
│                                        │
└────────────────────────────────────────┘
```

**实现要点**：
```python
# 设备发现
def scan_devices() -> List[DeviceInfo]:
    """扫描所有在线设备"""
    devices = dai.DeviceBootloader.getAllAvailableDevices()
    return [DeviceInfo(mxid=d.getMxId(), name=d.name) for d in devices]

# 设备预览
def preview_device(mxid: str) -> None:
    """启动短暂的视频流预览"""
    with dai.Device(dai.DeviceInfo(mxid)) as device:
        # 创建简单的预览pipeline
        pipeline = create_preview_pipeline()
        device.startPipeline(pipeline)
        # 显示视频流（OpenCV窗口）
        show_video_stream(device)
```

#### 功能1.2：角色分配

```
界面布局：
┌────────────────────────────────────────┐
│  设备绑定工具 - 角色分配              │
├────────────────────────────────────────┤
│                                        │
│  当前设备: 14442C10D13D0D0000         │
│                                        │
│  ┌─ 视频预览 ──────────────────────┐  │
│  │                                  │  │
│  │      [实时视频画面]              │  │
│  │                                  │  │
│  └──────────────────────────────────┘  │
│                                        │
│  分配角色:                             │
│  ○ LEFT_CAMERA  (左相机)              │
│  ○ RIGHT_CAMERA (右相机)              │
│  ○ CENTER_CAMERA (中央相机)           │
│                                        │
│  设备备注:                             │
│  ┌──────────────────────────────────┐ │
│  │ 2025年10月购入，主力设备         │ │
│  └──────────────────────────────────┘ │
│                                        │
│  [上一步] [确认绑定] [下一步]          │
│                                        │
└────────────────────────────────────────┘
```

**实现要点**：
```python
def bind_device_to_role(mxid: str, role: DeviceRole, notes: str) -> None:
    """绑定设备到角色"""
    # 1. 更新角色绑定
    binding = config.role_bindings.get(role)
    if binding is None:
        binding = DeviceRoleBindingDTO(role=role, historical_mxids=[])
        config.role_bindings[role] = binding
    
    # 添加到历史MXid列表（如果不存在）
    if mxid not in binding.historical_mxids:
        binding.historical_mxids.append(mxid)
    
    # 2. 更新设备元数据
    metadata = DeviceMetadataDTO(
        mxid=mxid,
        notes=notes,
        first_seen=time.time()
    )
    config.device_metadata[mxid] = metadata
    
    # 3. 保存配置
    config_manager.save_config()
```

#### 功能1.3：绑定总览与确认

```
界面布局：
┌────────────────────────────────────────┐
│  设备绑定工具 - 绑定总览              │
├────────────────────────────────────────┤
│                                        │
│  绑定结果：                            │
│                                        │
│  ┌──────────────────────────────────┐ │
│  │ ✅ LEFT_CAMERA                   │ │
│  │    └─ 14442C10D13D0D0000         │ │
│  │       备注: 主力设备             │ │
│  │                                  │ │
│  │ ✅ RIGHT_CAMERA                  │ │
│  │    └─ 14442C10D13D0D0001         │ │
│  │       备注: 备用设备             │ │
│  │                                  │ │
│  │ ⚠️  CENTER_CAMERA                │ │
│  │    └─ 未绑定设备                 │ │
│  └──────────────────────────────────┘ │
│                                        │
│  [返回修改] [保存并继续]               │
│                                        │
└────────────────────────────────────────┘
```

---

### 阶段2：坐标变换参数调整工具（GUI）

**目标**：为每个角色配置精确的坐标变换参数

#### 功能2.1：手动调整模式

```
界面布局：
┌──────────────────────────────────────────────────┐
│  坐标变换参数调整 - 手动模式                   │
├──────────────────────────────────────────────────┤
│  选择角色: [LEFT_CAMERA ▼]                      │
│                                                  │
│  ┌─ 实时视频 ────────┐ ┌─ 参数调整 ──────────┐ │
│  │                    │ │                      │ │
│  │  [实时视频画面]    │ │  平移 X: [100.0] mm │ │
│  │                    │ │  ━━━━●━━━━          │ │
│  │  检测结果叠加      │ │                      │ │
│  │                    │ │  平移 Y: [50.0] mm  │ │
│  └────────────────────┘ │  ━━━━●━━━━          │ │
│                         │                      │ │
│  ┌─ 机械臂位置 ────────┤  平移 Z: [200.0] mm │ │
│  │ X: 120.5 mm         │  ━━━━━━●━━━          │ │
│  │ Y: 68.3 mm          │                      │ │
│  │ Z: 205.2 mm         │  旋转 Roll: [0.0]°  │ │
│  └─────────────────────┤  ━━●━━━━━━━          │ │
│                         │                      │ │
│  误差: ΔX=20.5  ΔY=18.3 │  旋转 Pitch: [0.0]° │ │
│        ΔZ=5.2           │  ━━●━━━━━━━          │ │
│                         │                      │ │
│  [模拟抓取] [应用参数]  │  旋转 Yaw: [45.0]°  │ │
│  [重置] [保存]          │  ━━━━━━●━━━          │ │
│                         │                      │ │
│                         │  [热更新] [保存]     │ │
│                         └──────────────────────┘ │
└──────────────────────────────────────────────────┘
```

**实现要点**：
```python
class CoordinateCalibrationTool:
    """坐标变换参数调整工具"""
    
    def __init__(self, config_manager: SystemConfigManager):
        self.config = config_manager
        self.current_role = DeviceRole.LEFT_CAMERA
        
    def update_transform_parameter(self, param: str, value: float) -> None:
        """热更新变换参数"""
        transform = self.config.coordinate_transforms[self.current_role]
        
        # 更新参数
        if param == "translation_x":
            transform.translation = (value, transform.translation[1], transform.translation[2])
        elif param == "rotation_yaw":
            transform.rotation = (transform.rotation[0], transform.rotation[1], value)
        # ... 其他参数
        
        # 立即应用（不保存到文件）
        self.apply_transform_realtime(transform)
    
    def simulate_grasp(self, target_position: Tuple[float, float, float]) -> Dict[str, float]:
        """模拟抓取，测量误差"""
        # 1. 发送目标位置到运动控制模块
        motion_controller.move_to(target_position)
        
        # 2. 等待运动完成
        motion_controller.wait_until_stopped()
        
        # 3. 获取实际位置
        actual_position = motion_controller.get_current_position()
        
        # 4. 计算误差
        error = {
            "dx": actual_position[0] - target_position[0],
            "dy": actual_position[1] - target_position[1],
            "dz": actual_position[2] - target_position[2]
        }
        
        return error
    
    def save_transform_parameters(self) -> None:
        """保存参数到配置文件"""
        self.config.save_config()
```

#### 功能2.2：自动调整模式（未来实现）

```
界面布局：
┌──────────────────────────────────────────────────┐
│  坐标变换参数调整 - 自动模式                   │
├──────────────────────────────────────────────────┤
│                                                  │
│  步骤1: 放置标定板                               │
│  ┌────────────────────────────────────────────┐ │
│  │  [标定板实时画面]                          │ │
│  │  检测到标定板: ✅                           │ │
│  └────────────────────────────────────────────┘ │
│                                                  │
│  步骤2: 自动采集数据                             │
│  进度: ████████░░░░ 8/12 个位置                 │
│                                                  │
│  步骤3: 计算变换参数                             │
│  状态: 计算中...                                 │
│                                                  │
│  步骤4: 验证精度                                 │
│  标定精度: 1.2 mm (优秀)                         │
│                                                  │
│  [开始自动标定] [取消]                           │
│                                                  │
└──────────────────────────────────────────────────┘
```

---

### 阶段3：参数调试工具集（GUI）

**目标**：提供便捷的界面调整各类参数

#### 功能3.1：滤波参数调整

```
界面布局：
┌──────────────────────────────────────────────────┐
│  滤波参数调整                                   │
├──────────────────────────────────────────────────┤
│                                                  │
│  滤波器类型: [卡尔曼滤波 ▼]                      │
│                                                  │
│  ┌─ 原始数据 vs 滤波后 ──────────────────────┐  │
│  │                                            │  │
│  │  Y                                         │  │
│  │  ↑  原始 ········                          │  │
│  │  │  滤波 ────                              │  │
│  │  │        ····  ──                         │  │
│  │  │    ····    ──                           │  │
│  │  │  ··    ──                               │  │
│  │  └────────────────────────────────→ 时间   │  │
│  └────────────────────────────────────────────┘  │
│                                                  │
│  卡尔曼增益: [0.5]  ━━━━●━━━━                    │
│  过程噪声:   [0.1]  ━━●━━━━━━                    │
│  测量噪声:   [0.5]  ━━━━●━━━━                    │
│                                                  │
│  [应用] [重置] [保存]                            │
│                                                  │
└──────────────────────────────────────────────────┘
```

#### 功能3.2：PID参数调整

```
界面布局：
┌──────────────────────────────────────────────────┐
│  PID参数调整 - 运动控制                         │
├──────────────────────────────────────────────────┤
│                                                  │
│  ┌─ 响应曲线 ─────────────────────────────────┐ │
│  │ 位置                                        │ │
│  │  ↑  目标 ────                              │ │
│  │  │  实际 ····                              │ │
│  │  │      ────────────────                   │ │
│  │  │    ····超调                             │ │
│  │  │  ··                                     │ │
│  │  └────────────────────────────────→ 时间   │ │
│  └────────────────────────────────────────────┘ │
│                                                  │
│  P (比例): [1.2]  ━━━━━●━━━                      │
│  I (积分): [0.1]  ━━●━━━━━━                      │
│  D (微分): [0.05] ━●━━━━━━━                      │
│                                                  │
│  响应时间: 0.8s  | 超调: 5%  | 稳定误差: 0.2mm  │
│                                                  │
│  [测试运动] [应用] [保存]                        │
│                                                  │
└──────────────────────────────────────────────────┘
```

#### 功能3.3：检测参数调整

```
界面布局：
┌──────────────────────────────────────────────────┐
│  检测参数调整                                   │
├──────────────────────────────────────────────────┤
│                                                  │
│  ┌─ 实时检测预览 ─────────────────────────────┐ │
│  │                                            │ │
│  │  [实时视频]                                │ │
│  │                                            │ │
│  │  检测到: 3个目标                           │ │
│  │  FPS: 28                                   │ │
│  └────────────────────────────────────────────┘ │
│                                                  │
│  置信度阈值: [0.5]  ━━━━●━━━━                    │
│  NMS阈值:    [0.4]  ━━━●━━━━━                    │
│  最大检测数: [10]   ━━━━━●━━━                    │
│                                                  │
│  深度过滤:                                       │
│  最小深度: [400] mm   ━━●━━━━━━                  │
│  最大深度: [7000] mm  ━━━━━━━●━                  │
│                                                  │
│  [应用] [重置] [保存]                            │
│                                                  │
└──────────────────────────────────────────────────┘
```

---

### 阶段4：自动抓取系统（最终目标）

**目标**：整合所有模块，实现完整的自动抓取流程

```
自动抓取流程：
┌─────────────────────────────────────────┐
│ 1. 系统启动                             │
│    ├─ 加载配置文件                      │
│    ├─ 自动识别设备（historical_mxids）  │
│    ├─ 加载坐标变换参数                  │
│    └─ 启动各模块                        │
├─────────────────────────────────────────┤
│ 2. 视觉检测                             │
│    ├─ 双目视觉采集                      │
│    ├─ 目标检测                          │
│    ├─ 深度估计                          │
│    └─ 坐标变换                          │
├─────────────────────────────────────────┤
│ 3. 数据处理                             │
│    ├─ 坐标滤波                          │
│    ├─ 目标选择                          │
│    └─ 轨迹规划                          │
├─────────────────────────────────────────┤
│ 4. 运动控制                             │
│    ├─ 发送目标位置                      │
│    ├─ PID控制                           │
│    └─ 执行抓取                          │
├─────────────────────────────────────────┤
│ 5. 结果反馈                             │
│    ├─ 抓取成功/失败                     │
│    ├─ 记录日志                          │
│    └─ 统计分析                          │
└─────────────────────────────────────────┘
```

---

## 🏗️ DTO架构设计

### 核心DTO类

#### 1. DeviceRoleBindingDTO（设备角色绑定）

```python
@dataclass
class DeviceRoleBindingDTO(BaseDTO):
    """
    设备角色绑定
    
    核心思想：角色是固定的功能位置，记住曾经用过的MXid
    """
    role: DeviceRole                          # 功能角色（主键）
    historical_mxids: List[str]               # 曾经使用过的MXid（用于自动识别）
    active_mxid: Optional[str] = None         # 当前激活的MXid（运行时）
    last_active_mxid: Optional[str] = None    # 上次使用的MXid（运行时持久化）
```

**字段说明**：
- `role`: 功能角色，如 LEFT_CAMERA，是主键
- `historical_mxids`: 曾经绑定过的所有MXid，用于启动时自动识别
- `active_mxid`: 当前激活的MXid，运行时设置，不保存到配置文件
- `last_active_mxid`: 上次启动时使用的MXid，保存到配置文件，用于快速检查设备是否切换

#### 2. DeviceMetadataDTO（设备元数据）

```python
@dataclass
class DeviceMetadataDTO(BaseDTO):
    """
    设备元数据（按MXid索引）
    
    用途：记录每个物理设备的详细信息
    """
    mxid: str                                 # 设备MXid（主键）
    notes: Optional[str] = None               # 用户备注
    device_type: DeviceType = DeviceType.UNKNOWN
    
    # 设备发现记录
    first_seen: float = field(default_factory=time.time)
    last_seen: float = field(default_factory=time.time)
    
    # 设备健康状态（可选，未来扩展）
    health_status: Optional[str] = None       # "good", "warning", "error"
    total_usage_hours: Optional[float] = None
```

#### 3. CoordinateTransformConfigDTO（坐标变换配置）

```python
@dataclass
class CoordinateTransformConfigDTO(BaseDTO):
    """
    坐标变换配置（按role索引）
    
    设计理念：变换参数绑定到角色，不绑定到MXid
    """
    role: DeviceRole                          # 功能角色
    
    # 变换参数
    translation: Tuple[float, float, float] = (0.0, 0.0, 0.0)  # 平移 (x, y, z) mm
    rotation: Tuple[float, float, float] = (0.0, 0.0, 0.0)     # 旋转 (roll, pitch, yaw) 度
    scale: float = 1.0                        # 缩放因子
    
    # 或者使用4x4变换矩阵（二选一）
    transform_matrix: Optional[List[List[float]]] = None
    
    # 标定信息
    calibration_date: Optional[str] = None
    calibration_method: Optional[str] = None  # "manual" / "auto"
    calibration_accuracy: Optional[float] = None  # 精度 (mm)
```

#### 4. FilterConfigDTO（滤波器配置）

```python
@dataclass
class FilterConfigDTO(BaseDTO):
    """滤波器配置"""
    filter_type: str = "kalman"               # "kalman" / "lowpass" / "median"
    
    # 卡尔曼滤波参数
    kalman_gain: float = 0.5
    process_noise: float = 0.1
    measurement_noise: float = 0.5
    
    # 低通滤波参数
    cutoff_frequency: Optional[float] = None
    
    # 中值滤波参数
    window_size: Optional[int] = None
```

#### 5. PIDConfigDTO（PID配置）

```python
@dataclass
class PIDConfigDTO(BaseDTO):
    """PID控制器配置"""
    p_gain: float = 1.0                       # 比例增益
    i_gain: float = 0.0                       # 积分增益
    d_gain: float = 0.0                       # 微分增益
    
    # 限制
    output_limit: Tuple[float, float] = (-100.0, 100.0)
    integral_limit: Tuple[float, float] = (-50.0, 50.0)
```

#### 6. DeviceManagerConfigDTO（设备管理器配置 - 顶层）

```python
@dataclass
class DeviceManagerConfigDTO(BaseDTO):
    """设备管理器配置（整合所有配置）"""
    
    config_version: str = "2.0.0"
    
    # ===== 设备角色绑定（按role索引）=====
    role_bindings: Dict[DeviceRole, DeviceRoleBindingDTO] = field(default_factory=dict)
    
    # ===== 设备元数据（按MXid索引）=====
    device_metadata: Dict[str, DeviceMetadataDTO] = field(default_factory=dict)
    
    # ===== 坐标变换配置（按role索引）=====
    coordinate_transforms: Dict[DeviceRole, CoordinateTransformConfigDTO] = field(default_factory=dict)
    
    # ===== 其他配置模块 =====
    oak_config: OAKConfigDTO = field(default_factory=OAKConfigDTO)
    system: SystemConfigDTO = field(default_factory=SystemConfigDTO)
    filter_config: FilterConfigDTO = field(default_factory=FilterConfigDTO)
    pid_config: PIDConfigDTO = field(default_factory=PIDConfigDTO)
    
    # ===== 历史记录 =====
    history: List[DeviceHistoryDTO] = field(default_factory=list)
    
    # ===== 配置选项 =====
    predefined_roles: List[DeviceRole] = field(
        default_factory=lambda: [DeviceRole.LEFT_CAMERA, DeviceRole.RIGHT_CAMERA]
    )
    strict_mode: bool = True
```

---

## 📄 配置文件结构

```json
{
  "config_version": "2.0.0",
  
  "role_bindings": {
    "left_camera": {
      "role": "left_camera",
      "historical_mxids": [
        "14442C10D13D0D0000",
        "14442C10D13D0D0001"
      ],
      "active_mxid": null,
      "last_active_mxid": "14442C10D13D0D0000"
    },
    "right_camera": {
      "role": "right_camera",
      "historical_mxids": [
        "14442C10D13D0D0002"
      ],
      "active_mxid": null,
      "last_active_mxid": "14442C10D13D0D0002"
    }
  },
  
  "device_metadata": {
    "14442C10D13D0D0000": {
      "mxid": "14442C10D13D0D0000",
      "notes": "2025年10月购入，主力设备",
      "device_type": "OAK-D",
      "first_seen": 1696780800.0,
      "last_seen": 1696867200.0,
      "health_status": "good"
    }
  },
  
  "coordinate_transforms": {
    "left_camera": {
      "role": "left_camera",
      "translation": [100.0, 50.0, 200.0],
      "rotation": [0.0, 0.0, 45.0],
      "scale": 1.0,
      "calibration_date": "2025-10-08",
      "calibration_method": "manual",
      "calibration_accuracy": 2.5
    }
  },
  
  "filter_config": {
    "filter_type": "kalman",
    "kalman_gain": 0.5,
    "process_noise": 0.1,
    "measurement_noise": 0.5
  },
  
  "pid_config": {
    "p_gain": 1.2,
    "i_gain": 0.1,
    "d_gain": 0.05,
    "output_limit": [-100.0, 100.0]
  },
  
  "oak_config": { ... },
  "system": { ... }
}
```

---

## 🗺️ 开发路线图

### 第1阶段：DTO架构重构（当前）

- [ ] 重新设计 `DeviceRoleBindingDTO`
- [ ] 新增 `DeviceMetadataDTO`
- [ ] 新增 `CoordinateTransformConfigDTO`
- [ ] 新增 `FilterConfigDTO` 和 `PIDConfigDTO`
- [ ] 更新 `DeviceManagerConfigDTO`
- [ ] 编写单元测试
- [ ] 更新配置管理器以支持新架构

### 第2阶段：设备绑定工具（CLI版本）

- [ ] 实现设备发现功能
- [ ] 实现设备预览功能
- [ ] 实现角色绑定功能
- [ ] 实现配置保存功能
- [ ] 编写使用文档

### 第3阶段：自动设备识别（运行时）

- [ ] 实现设备匹配算法
- [ ] 实现冲突检测
- [ ] 实现单相机启动支持
- [ ] 集成到系统启动流程

### 第4阶段：GUI工具开发

- [ ] 设备绑定工具GUI
- [ ] 坐标变换参数调整GUI
- [ ] 滤波参数调整GUI
- [ ] PID参数调整GUI
- [ ] 检测参数调整GUI

### 第5阶段：自动抓取系统集成

- [ ] 完整的数据流水线
- [ ] 运动控制集成
- [ ] 闭环控制
- [ ] 性能优化
- [ ] 生产部署

---

## 📝 总结

这个软件设想体现了以下设计原则：

1. **模块化** - 每个功能独立，便于开发和维护
2. **配置驱动** - 通过配置文件管理所有参数，无需修改代码
3. **用户友好** - 提供GUI工具辅助调试和配置
4. **生产就绪** - 设备可热插拔，参数可热更新，支持单相机运行
5. **可扩展** - 预留接口，便于添加新功能

**下一步**：重构DTO架构，实现新的设备角色绑定机制。
